(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{242:function(e,t,a){e.exports=a(631)},347:function(e,t){},348:function(e,t){},629:function(e,t,a){},631:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"setCountries",function(){return Y}),a.d(n,"setIndicators",function(){return J}),a.d(n,"setLocation",function(){return H}),a.d(n,"setCountryValue",function(){return Q}),a.d(n,"setIndicatorValue",function(){return X}),a.d(n,"setWidgetData",function(){return K}),a.d(n,"setWidgetStats",function(){return Z}),a.d(n,"setWidth",function(){return $}),a.d(n,"default",function(){return ee});var r={};a.r(r),a.d(r,"setMap",function(){return re}),a.d(r,"setMapBounds",function(){return ce}),a.d(r,"setMapStyle",function(){return oe}),a.d(r,"setMapLabels",function(){return ie}),a.d(r,"setMapRoads",function(){return se}),a.d(r,"setBasemap",function(){return ue}),a.d(r,"setMapViewport",function(){return le}),a.d(r,"setMapLoaded",function(){return de}),a.d(r,"setMapFlying",function(){return pe}),a.d(r,"getCountryBounds",function(){return me}),a.d(r,"default",function(){return fe});var c={};a.r(c),a.d(c,"setCountriesData",function(){return Ie}),a.d(c,"loadDashboardData",function(){return Re}),a.d(c,"getIndicators",function(){return Te}),a.d(c,"getCountriesData",function(){return _e}),a.d(c,"getProvincesData",function(){return xe}),a.d(c,"default",function(){return Pe});var o={};a.r(o),a.d(o,"setDashboardCollapsed",function(){return Be}),a.d(o,"setModalState",function(){return Fe}),a.d(o,"setCountry",function(){return We}),a.d(o,"setIndicator",function(){return Ue}),a.d(o,"setUrl",function(){return Ge}),a.d(o,"saveData",function(){return ze});var i={};a.r(i),a.d(i,"default",function(){return Ve});var s={};a.r(s),a.d(s,"actions",function(){return o}),a.d(s,"initialState",function(){return qe}),a.d(s,"reducers",function(){return i});var u={};a.r(u),a.d(u,"default",function(){return Ye});var l={};a.r(l),a.d(l,"actions",function(){return c}),a.d(l,"initialState",function(){return Je}),a.d(l,"reducers",function(){return u});var d={};a.r(d),a.d(d,"pageActions",function(){return Xe}),a.d(d,"setPage",function(){return Ke});var p={};a.r(p),a.d(p,"default",function(){return Ze});var m={};a.r(m),a.d(m,"actions",function(){return d}),a.d(m,"initialState",function(){return $e}),a.d(m,"reducers",function(){return p});var f={};a.r(f),a.d(f,"default",function(){return et});var b={};a.r(b),a.d(b,"actions",function(){return r}),a.d(b,"initialState",function(){return tt}),a.d(b,"reducers",function(){return f});var h={};a.r(h),a.d(h,"setList",function(){return at}),a.d(h,"setLoading",function(){return nt}),a.d(h,"setError",function(){return rt}),a.d(h,"setLayersOpacity",function(){return ct}),a.d(h,"getLayers",function(){return ot}),a.d(h,"default",function(){return it});var g={};a.r(g),a.d(g,"default",function(){return st});var v={};a.r(v),a.d(v,"actions",function(){return h}),a.d(v,"initialState",function(){return ut}),a.d(v,"reducers",function(){return g});var O={};a.r(O),a.d(O,"default",function(){return lt});var y={};a.r(y),a.d(y,"actions",function(){return n}),a.d(y,"initialState",function(){return dt}),a.d(y,"reducers",function(){return O});var j=a(1),E=a.n(j),w=a(63),k=a.n(w),A=a(19),D=a(17),N=a(4),C=a(3),S=a(53),M=a(233),L=a(234),I=a(6),R=a(241),T=a(34),_=a(35),x=a(235),P=a.n(x),B=new(function(){function e(){Object(T.a)(this,e)}return Object(_.a)(e,[{key:"saveAsJSON",value:function(e){var t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e));this.triggerDownload("dataset.json",t)}},{key:"saveAsCSV",value:function(e){var t=e.map(function(e){var t=e.indicators,a=Object(R.a)(e,["indicators"]);return t?Object(C.a)({},a,Object.fromEntries(Object.entries(e.indicators).flatMap(function(e){return Object.entries(e[1]).map(function(t){return["".concat(e[0],"_").concat(t[0]),t[1]]})}))):Object(C.a)({},a)}),a=Object.keys(t[0]),n=P.a.parse(t,{fields:a}),r="data:text/csv;charset=utf-8,"+encodeURIComponent(n);this.triggerDownload("dataset.csv",r)}},{key:"saveRankings",value:function(){var e="".concat(".","/Aqueduct30_Rankings_V01.xlsx");this.triggerDownload("Aqueduct30_Rankings_V01.xlsx",e)}},{key:"triggerDownload",value:function(e,t){var a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",e),a.click()}}]),e}()),F=[{label:"Baseline Water Stress",value:"bws"},{label:"Drought Risk",value:"drr"},{label:"Riverine Flood Risk",value:"rfr"}],W={Tot:"Total",Dom:"Domestic",Ind:"Industrial",Irr:"Agricultural",Liv:"Livestock",Pop:"Population",Avg:"Average"},U={MISSING_REQUIRED_PARAMETER:"Required parameter is not present.",MISSING_WIDGET_REQUEST_PARAMETERS:"Cannot make widget data request. Missing parameters."};function G(e){return e.filter(function(e){return"Tot"!==e.category}).reduce(function(e,t,a,n){var r=n.length;return a===r-1?(e+t.score)/r:e+t.score},0)}function z(e){return e?e.toFixed(2):"NO DATA"}function V(e){if(1===e.length){var t=e[0];return Object(N.a)({},t.category,{name:W[t.category],score:z(t.score),rank:t.rank})}return e.reduce(function(t,a){var n;return Object(C.a)({},t,(n={},Object(N.a)(n,a.category,{name:W[a.category],score:z(a.score),rank:a.rank}),Object(N.a)(n,"Avg",{name:W.Avg,score:G(e).toFixed(2)}),n))},{})}var q=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"country";return{iso:e,name:t[0][a],indicators:V(t)}},Y=Object(I.createAction)("DASHBOARD/setCountries"),J=Object(I.createAction)("DASHBOARD/setIndicators"),H=Object(I.createAction)("DASHBOARD/setLocation"),Q=Object(I.createAction)("DASHBOARD/setCountryValue"),X=Object(I.createAction)("DASHBOARD/setIndicatorValue"),K=Object(I.createAction)("DASHBOARD/setWidgetData"),Z=Object(I.createAction)("DASHBOARD/setWidgetStats"),$=Object(I.createAction)("DASHBOARD/setWidth"),ee={setLocation:H,setCountryValue:Q,setIndicatorValue:X},te={GENERAL:"GENERAL",COUNTRY:"COUNTRY"},ae=a(41),ne=a.n(ae),re=Object(I.createAction)("MAP/setMap"),ce=Object(I.createAction)("MAP/setMapBounds"),oe=Object(I.createAction)("MAP/setMapStyle"),ie=Object(I.createAction)("MAP/setMapLabels"),se=Object(I.createAction)("MAP/setMapRoads"),ue=Object(I.createAction)("MAP/setBasemap"),le=Object(I.createAction)("MAP/setMapViewport"),de=Object(I.createAction)("MAP/setMapLoaded"),pe=Object(I.createAction)("MAP/setMapFlying"),me=Object(I.createThunkAction)("MAP/getCountryBounds",function(){return function(e,t){var a=t().dashboard,n=a.locationId,r=a.width,c="SELECT ST_AsGeoJSON(ST_AsText(ST_Envelope(the_geom))) as geometry, gid_0, name_0 FROM gadm_wri_0 WHERE gid_0 = '".concat(n,"'");ne.a.get("https://wri-rw.carto.com/api/v2/sql?q=".concat(c)).then(function(t){var a=t.data.rows;if(a.length<1)return e(ce({bbox:[-180,90,180,-90]}));var n=JSON.parse(a[0].geometry),c=window.L.geoJSON(n).getBounds().toBBoxString().split(",").map(function(e){return parseFloat(e)});e(ce({bbox:c,options:{paddingTopLeft:[r,0]}}))})}}),fe={setMap:re,setMapBounds:ce,setMapStyle:oe,setBasemap:ue,setMapLabels:ie,setMapRoads:se,setMapViewport:le,setMapLoaded:de,setMapFlying:pe,getCountryBounds:me},be=a(24),he=a.n(be),ge=a(157),ve=a(65),Oe=a(45),ye=a(73),je=a.n(ye),Ee=function(e){var t=e.id,a=e.type,n=e.attributes;return Object.assign({},{id:t,type:a},n)},we=function(e){var t=e.id,a=e.type,n=e.attributes,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=Object.assign({},{id:t,type:a},n);return Object.prototype.hasOwnProperty.call(c,"widget")&&(c.widget=c.widget.map(Ee)),Object.prototype.hasOwnProperty.call(c,"layer")&&(c.layer=c.layer.map(Ee)),Object.prototype.hasOwnProperty.call(c,"metadata")&&(c.metadata=c.metadata.map(Ee),r.locale&&(c.metadata=c.metadata.find(function(e){return e.language===r.locale})||{})),Object.prototype.hasOwnProperty.call(c,"vocabulary")&&(c.vocabulary=c.vocabulary.map(Ee)),Object.prototype.hasOwnProperty.call(c,"legendConfig")&&Object.prototype.hasOwnProperty.call(c.legendConfig,"items")&&(c.legendConfig.items=c.legendConfig.items.map(function(e,t){var a=Object.assign({},e);return a.id=a.id||t,a})),c},ke=function(e){var t=e.data,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&Array.isArray(t)?t.map(function(e){return we(e,a)}):we(t,a)};var Ae,De,Ne,Ce,Se,Me=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},n={length:0,sum:null,max:null,min:null};return e.reduce(function(e,r){var c=je()(r,t),o=a(r);return("iso"===t?r.country:r.province)?(r.score&&(n.length++,n.sum+=r.score,n.min?r.score<n.min&&(n.min=r.score):n.min=r.score,n.max?r.score>n.max&&(n.max=r.score):n.max=r.score),e[c]?e[c].push(o):e[c]=[o],e):e},{_stats:n})},Le=new(function(){function e(){Object(T.a)(this,e),this.client=ne.a.create({baseURL:"https://staging-api.globalforestwatch.org/v1",headers:{"Content-Type":"application/json"}})}return Object(_.a)(e,[{key:"fetchLayersFromDataset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.client.get("/dataset/".concat(e,"/layer"),{params:t}).then(function(e){var t=e.status,a=e.statusText,n=e.data;if(t>=400)throw new Error(a);return ke(n)})}},{key:"fetchDatasetsLayers",value:function(e){var t=this,a=Object.entries(e).reduce(function(e,a){return[[].concat(Object(ve.a)(e[0]),[a[0]]),[].concat(Object(ve.a)(e[1]),[t.fetchLayersFromDataset(a[1])])]},[[],[]]),n=Object(Oe.a)(a,2),r=n[0],c=n[1];return ne.a.all(c).then(function(e){return r.reduce(function(t,a,n){return Object(C.a)({},t,Object(N.a)({},a,e[n]))},{})})}},{key:"fetchDatasetWidgets",value:function(e){var t=this,a=je()(e,"widget.id",null),n=je()(e,"widget.params",null),r=je()(e,"params",{});if(a&&n)return this.client("/widget/".concat(a),r).then(function(e){var t=e.status,a=e.statusText,n=e.data;if(t>=400)throw new Error(a);return ke(n)}).then(function(e){var a=t.processWidgetData(e,n);return ne.a.get(a)}).then(function(t){var a=t.status,n=t.statusText,r=t.data;if(a>=400)throw new Error(n);return Me(r.rows,e.indexKey,function(t){return{country:"iso"===e.indexKey?t.country:t.province,category:t.weight,score:t.score,rank:t.score_ranked}})});throw new Error(U.MISSING_WIDGET_REQUEST_PARAMETERS)}},{key:"processWidgetData",value:function(e,t){var a=e.widgetConfig,n=a.data;return a.params_config.reduce(function(e,a){var n=a.key;if(a.required&&!t[n])throw new Error(U.MISSING_REQUIRED_PARAMETER);return e.replace("{{".concat(n,"}}"),"'".concat(t[n],"'"))},n[0].url)}}]),e}()),Ie=Object(I.createAction)("DATA/setCountriesData"),Re=Object(I.createThunkAction)("DATA/loadDashboardData",function(){return function(e,t){var a=t().router.query||{},n=a.country,r=a.indicator;e(Te()),r&&e(X({data:r})),e(_e()).then(function(t){var a=Object.entries(t).filter(function(e){return"_stats"!==e[0]}).map(function(e){return q(e[0],e[1])});n?e(We({data:n.toUpperCase()})):(e(Z({data:t._stats})),e(K({data:a})))})}}),Te=Object(I.createThunkAction)("DATA/getIndicators",function(){return function(e){e(J({data:F})),e(X({data:F[0].value}))}}),_e=Object(I.createThunkAction)("DATA/getCountriesData",function(){return function(){var e=Object(ge.a)(he.a.mark(function e(t,a){var n,r,c;return he.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a().dashboard,r=n.indicators.value){e.next=4;break}return e.abrupt("return");case 4:return c={widget:{id:"e6e5d286-212b-48d8-b5f4-1678cded82bc",params:{indicator:r}},indexKey:"iso"},e.next=7,Le.fetchDatasetWidgets(c).then(function(e){var a=Object.entries(e).filter(function(e){return"_stats"!==e[0]}).map(function(e){return{label:e[1][0].country,value:e[0]}}).sort(function(e,t){return e.label&&t.label?e.label.localeCompare(t.label):-1});return t(Y({data:a})),t(Ie({data:e})),e});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()}),xe=Object(I.createThunkAction)("DATA/getProvincesData",function(){return function(){var e=Object(ge.a)(he.a.mark(function e(t,a){var n,r,c,o;return he.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a().dashboard,r=n.locationId,c=n.indicators.value){e.next=4;break}return e.abrupt("return");case 4:return o={widget:{id:"4b3d6e89-869c-45b6-88e3-28735d2b60fe",params:{indicator:c,iso:r}},indexKey:"province"},e.next=7,Le.fetchDatasetWidgets(o);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()}),Pe={getIndicators:Te,getCountriesData:_e,getProvincesData:xe},Be=Object(I.createAction)("APP/setDashboardCollapsed"),Fe=Object(I.createAction)("APP/setModalState"),We=Object(I.createThunkAction)("APP/setCountry",function(e){return function(t){t(H(e)),t(Q(e)),t(Ge({params:{country:e.data}})),t(me(e.data));var a=e.data?xe:_e;t(a()).then(function(e){var a=Object.entries(e).filter(function(e){return"_stats"!==e[0]}).map(function(e){return q(e[0],e[1])});t(Z({data:e._stats})),t(K({data:a}))}),e.data||t(ce({bbox:[-180,90,180,-90]}))}}),Ue=Object(I.createThunkAction)("APP/setIndicator",function(e){return function(t,a){t(X(e)),t(Ge({params:{indicator:e.data}}));var n=a().dashboard.scope;t((n===te.COUNTRY?xe:_e)()).then(function(e){var a=Object.entries(e).filter(function(e){return"_stats"!==e[0]}).map(function(e){return q(e[0],e[1])});t(Z({data:e._stats})),t(K({data:a}))})}}),Ge=Object(I.createThunkAction)("APP/saveData",function(e){var t=e.params,a=e.replace;return function(e,n){var r=n().router,c=r.type,o=r.query,i=a?Object(C.a)({},t):Object(C.a)({},o,t);e({type:c,query:Object.fromEntries(Object.entries(i).filter(function(e){return Boolean(e[1])}))})}}),ze=Object(I.createThunkAction)("APP/saveData",function(){return function(){B.saveRankings()}}),Ve=(Ae={},Object(N.a)(Ae,We,function(e,t){var a=t.payload;return Object(C.a)({},e,{country:a.value})}),Object(N.a)(Ae,Be,function(e,t){var a=t.payload;return Object(C.a)({},e,{isDashboardCollapsed:Boolean(a)})}),Object(N.a)(Ae,Fe,function(e,t){var a=t.payload;return Object(C.a)({},e,{isModalOpen:Boolean(a)})}),Ae),qe={isDashboardCollapsed:!1,isModalOpen:!1},Ye=(De={},Object(N.a)(De,Ie,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{countries:Object(C.a)({},e.countries,{data:a})})}),Object(N.a)(De,"DATA/getCountries_STARTED",function(e){return Object(C.a)({},e,{countries:Object(C.a)({},e.countries,{isLoading:!0})})}),Object(N.a)(De,"DATA/getCountries_SUCCEEDED",function(e){return Object(C.a)({},e,{countries:Object(C.a)({},e.countries,{isLoading:!1,isLoaded:!0})})}),Object(N.a)(De,"DATA/getIndicators_STARTED",function(e){return Object(C.a)({},e,{indicators:Object(C.a)({},e.indicators,{isLoading:!0})})}),Object(N.a)(De,"DATA/getIndicators_SUCCEEDED",function(e){return Object(C.a)({},e,{indicators:Object(C.a)({},e.indicators,{isLoading:!1,isLoaded:!0})})}),Object(N.a)(De,"DATA/getWidgetData_STARTED",function(e){return Object(C.a)({},e,{widget:Object(C.a)({},e.widget,{isLoading:!0})})}),Object(N.a)(De,"DATA/getWidgetData_SUCCEEDED",function(e){return Object(C.a)({},e,{widget:Object(C.a)({},e.widget,{isLoading:!1,isLoaded:!0})})}),De),Je={countries:{data:null,isLoading:!1,isLoaded:!1,error:null},provinces:{cache:[],data:null,isLoading:!1,isLoaded:!1,error:null},indicators:{data:null,isLoading:!1,isLoaded:!1,error:null}},He=a(40),Qe=[{name:"HOME",path:"/:iso?/:indicator?",page:"home"},{name:He.NOT_FOUND,path:"/404",page:"not-found"}],Xe=Qe.reduce(function(e,t){return Object(C.a)({},e,Object(N.a)({},t.name,Object(I.createAction)("PAGES/".concat(t.name))))},{}),Ke=Object(I.createAction)("PAGES/setPage"),Ze=Object.keys(Xe).reduce(function(e,t){return Object(C.a)({},e,Object(N.a)({},t,function(e){return function(t,a){var n=a.payload;return Object(C.a)({},t,{current:e,payload:n})}}(t)))},{}),$e={current:"HOME"},et=(Ne={},Object(N.a)(Ne,re,function(e,t){var a=t.payload;return Object(C.a)({},e,a)}),Object(N.a)(Ne,ce,function(e,t){var a=t.payload;return Object(C.a)({},e,{bounds:a})}),Object(N.a)(Ne,ue,function(e,t){var a=t.payload;return Object(C.a)({},e,{basemap:a})}),Object(N.a)(Ne,oe,function(e,t){var a=t.payload;return Object(C.a)({},e,{mapStyle:a})}),Object(N.a)(Ne,ie,function(e,t){var a=t.payload;return Object(C.a)({},e,{mapLabels:a})}),Object(N.a)(Ne,se,function(e,t){var a=t.payload;return Object(C.a)({},e,{mapRoads:a})}),Object(N.a)(Ne,le,function(e,t){var a=t.payload;return Object(C.a)({},e,{viewport:a})}),Object(N.a)(Ne,de,function(e,t){var a=t.payload;return Object(C.a)({},e,{settings:{isLoaded:a}})}),Object(N.a)(Ne,pe,function(e,t){var a=t.payload;return Object(C.a)({},e,{settings:{isFlying:a}})}),Ne),tt={viewport:{zoom:2,latitude:41.145218001222204,longitude:-8.61132408966133},basemap:"hydro"},at=Object(I.createAction)("LAYERS/setList"),nt=Object(I.createAction)("LAYERS/setLoading"),rt=Object(I.createAction)("LAYERS/setError"),ct=Object(I.createAction)("LAYERS/setLayersOpacity"),ot=Object(I.createThunkAction)("LAYERS/getLayers",function(){return function(e){e(nt(!0)),e(rt(null));return Le.fetchDatasetsLayers({country_rankings:"fd4b4ba5-a16a-45a4-bc6b-954397e37bda",province_rankings:"e0adfbfb-441d-4ec5-9e4c-7d051d0f7b22"}).then(function(t){e(at(t)),e(nt(!1))}).catch(function(t){e(rt(t)),e(nt(!1))})}}),it={setList:at,setLoading:nt,setError:rt,getLayers:ot,setLayersOpacity:ct},st=(Ce={},Object(N.a)(Ce,at,function(e,t){var a=t.payload;return Object(C.a)({},e,{list:a})}),Object(N.a)(Ce,nt,function(e,t){var a=t.payload;return Object(C.a)({},e,{isLoading:Boolean(a)})}),Object(N.a)(Ce,rt,function(e,t){var a=t.payload;return Object(C.a)({},e,{error:a})}),Object(N.a)(Ce,ct,function(e,t){var a=t.payload;return Object(C.a)({},e,{list:{country_rankings:e.list.country_rankings.map(function(e){return Object(C.a)({},e,{opacity:a})}),province_rankings:e.list.province_rankings.map(function(e){return Object(C.a)({},e,{opacity:a})})}})}),Ce),ut={list:null,isLoading:!1,isLoaded:!1,error:null},lt=(Se={},Object(N.a)(Se,Y,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{countries:Object(C.a)({},e.countries,{list:a})})}),Object(N.a)(Se,J,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{indicators:Object(C.a)({},e.indicators,{list:a})})}),Object(N.a)(Se,H,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{locationId:a,scope:a?te.COUNTRY:te.GENERAL})}),Object(N.a)(Se,Q,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{countries:Object(C.a)({},e.countries,{value:a})})}),Object(N.a)(Se,X,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{indicators:Object(C.a)({},e.indicators,{value:a})})}),Object(N.a)(Se,K,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{widget:Object(C.a)({},e.widget,{data:a})})}),Object(N.a)(Se,Z,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{widget:Object(C.a)({},e.widget,{stats:a})})}),Object(N.a)(Se,$,function(e,t){var a=t.payload.data;return Object(C.a)({},e,{width:a})}),Se),dt={scope:te.GENERAL,locationId:null,width:null,countries:{list:[],value:null},indicators:{list:[],value:null},widget:{data:[]}},pt=a(236),mt=a.n(pt),ft=Qe.reduce(function(e,t){return Object(C.a)({},e,Object(N.a)({},t.name,Object(C.a)({path:t.path},{thunk:t.thunk})))},{}),bt={basename:"/applications/aqueduct/country-rankings/",location:"router",notFoundPath:"".concat("/applications/aqueduct/country-rankings/","404"),initialDispatch:!1,querySerializer:mt.a},ht=Object(He.connectRoutes)(ft,bt),gt=[{namespace:"app",components:s},{namespace:"data",components:l},{namespace:"page",components:m},{namespace:"map",components:b},{namespace:"layers",components:v},{namespace:"dashboard",components:y}],vt=ht.initialDispatch,Ot=ht.reducer,yt=ht.middleware,jt=ht.enhancer,Et=Object(S.combineReducers)(Object(C.a)({router:Ot},gt.reduce(function(e,t){return Object(C.a)({},e,Object(N.a)({},t.namespace,Object(I.handleModule)(t.components)))},{}))),wt=Object(S.applyMiddleware)(yt,M.a),kt=Object(L.composeWithDevTools)(jt,wt),At=Object(S.createStore)(Et,kt);vt();var Dt=At,Nt=Object(A.b)(function(e){return{}},{})(D.Modal),Ct=a(56),St=a(54),Mt=a(55),Lt=a(237),It=a.n(Lt),Rt=a(18),Tt=function(e){function t(e){var a;return Object(T.a)(this,t),(a=Object(Ct.a)(this,Object(St.a)(t).call(this,e))).state={copied:!1},a}return Object(Mt.a)(t,e),Object(_.a)(t,[{key:"componentWillMount",value:function(){this.props.getShareUrl(window.location.href)}},{key:"componentDidMount",value:function(){var e=this;this.clipboard=new It.a(this.btn),this.clipboard.on("success",function(t){e.setState({copied:!0}),setTimeout(function(){e.setState({copied:!1}),t.clearSelection()},2e3)}),this.clipboard.on("error",function(){e.setState({error:!0}),setTimeout(function(){e.setState({error:!1})},2e3)})}},{key:"triggerPopup",value:function(e){e&&e.preventDefault();var t=(window.innerWidth-575)/2,a=(window.innerHeight-400)/2,n=e.currentTarget.href,r="status=1,width=".concat(575,",height=").concat(400,",top=").concat(a,",left=").concat(t);window.open(n,"Share this analysis",r)}},{key:"render",value:function(){var e=this,t="Water and Food Security Analyzer",a=this.props.share.url||window.location.href,n=encodeURIComponent(this.props.share.url||window.location.href),r="Copy",c="";return this.state.copied&&(r="Copied",c="-success"),this.state.error&&(r="Error",c="-error"),E.a.createElement("div",{className:"c-share"},E.a.createElement("div",{className:"share-header"},E.a.createElement("h3",{className:"share-title"},"Share this page")),E.a.createElement("div",{className:"share-content"},E.a.createElement("div",{className:"share-button"},E.a.createElement("input",{id:"url",className:"share-url",value:a,readOnly:!0,onFocus:function(e){return e.currentTarget.select()}}),E.a.createElement("button",{"data-clipboard-target":"#url",ref:function(t){e.btn=t},className:"c-btn -primary ".concat(c),type:"button"},r)),E.a.createElement("div",{className:"share-sozial"},E.a.createElement("a",{href:"https://twitter.com/share?url=".concat(n),target:"_blank",rel:"noopener noreferrer",className:"c-btn -primary -with-icon -twitter -social",onClick:this.triggerPopup},E.a.createElement(Rt.Icon,{name:"icon-twitter"}),E.a.createElement("span",null,"Twitter")),E.a.createElement("a",{href:"https://www.facebook.com/sharer/sharer.php?u=".concat(n,"&t=").concat(t),target:"_blank",rel:"noopener noreferrer",className:"c-btn -primary -with-icon -facebook -social",onClick:this.triggerPopup},E.a.createElement(Rt.Icon,{name:"icon-facebook"}),E.a.createElement("span",null,"Facebook")),E.a.createElement("a",{href:"https://www.linkedin.com/shareArticle?mini=true&url=".concat(n,"&title=").concat(t,"&summary=&source="),target:"_blank",rel:"noopener noreferrer",className:"c-btn -primary -with-icon -linkedin -social",onClick:this.triggerPopup},E.a.createElement(Rt.Icon,{name:"icon-linkedin"}),E.a.createElement("span",null,"Linkedin")))))}}]),t}(E.a.Component);Tt.defaultProps={share:{},getShareUrl:function(e){return e}};var _t=a(74),xt=Object(_t.a)([function(e){return e.data}],function(e){return e.countries.data}),Pt=Object(_t.a)([function(e){return e.dashboard}],function(e){return e.locationId}),Bt=Object(_t.a)([Pt,xt],function(e,t){return e?q(e,t[e]):null}),Ft={container:function(e){return Object(C.a)({},e,{height:"40px"})},valueContainer:function(e){return Object(C.a)({},e,{height:"40px",marginLeft:"16px"})}},Wt=function(){return E.a.createElement("div",{className:"country-selector--icon"},E.a.createElement(Rt.Icon,{className:"-small",name:"icon-search"}))};function Ut(e){var t=e.countries,a=e.setCountry;return E.a.createElement(D.CustomSelect,{theme:"light",placeholder:"Search a country",options:t.list,onChange:function(e){a({data:e.value})},customClass:"c-country-selector",styles:Ft,components:{IndicatorsContainer:Wt},value:t.value})}Ut.defaultProps={setCountry:function(){console.log("Country value was changed.")}};var Gt=Ut,zt={setCountry:We},Vt=Object(A.b)(function(e){return{countries:e.dashboard.countries}},zt)(Gt),qt=a(119),Yt=a.n(qt);function Jt(e){var t=e.indicators,a=e.setIndicator,n=e.className;return E.a.createElement(D.Field,{name:"indication-filter",label:"Select Water Risk Indicator",className:"-bigger"},E.a.createElement(D.CustomSelect,{theme:"light",options:t.list,onChange:function(e){return a({data:e.value})},customClass:Yt()("c-indicator-selector",Object(N.a)({},n,Boolean(n))),value:t.value}))}Jt.defaultProps={setIndicator:function(){console.log("Indicator value was changed.")}};var Ht=Jt,Qt={setIndicator:Ue},Xt=Object(A.b)(function(e){return{indicators:e.dashboard.indicators}},Qt)(Ht),Kt=function(){return E.a.createElement("header",{className:"c-header"},E.a.createElement("div",{className:"header--content"},E.a.createElement(Vt,null),E.a.createElement(Xt,null),E.a.createElement("p",{className:"header--disclaimer"},"This map is for illustrative purposes and does not imply the expression of any opinion on the part of WRI concerning the legal status of any country or territory, or concerning the delimitation of frontiers or boundaries.")))},Zt=function(e){var t=e.onBackClick,a=e.data,n=["Irr","Dom","Ind","Tot"],r=Object.fromEntries(Object.entries(a.indicators).filter(function(e){return n.includes(e[0])}).sort(function(e,t){return n.indexOf(e[0])-n.indexOf(t[0])}));return E.a.createElement("header",{className:"c-header"},E.a.createElement("div",{className:"header--back-button",onClick:function(){return t()}},E.a.createElement(Rt.Icon,{className:"-small",name:"icon-arrow-left"}),E.a.createElement("span",{className:"-uppercase"},"Country Rankings")),E.a.createElement("div",{className:"header--content"},E.a.createElement("div",{className:"header--info"},E.a.createElement("h1",null,a.name),E.a.createElement(D.Field,{name:"header-indicators",label:"Summary Results",className:"-bigger"},E.a.createElement("ul",{className:"header--indicators"},Object.entries(r).map(function(e){return E.a.createElement("li",{className:"header--indicator",key:e[0]},e[1].name,": ",e[1].score)})))),E.a.createElement(Xt,{className:"header--indicator-selector"}),E.a.createElement("p",{className:"header--disclaimer"},"This map is for illustrative purposes and does not imply the expression of any opinion on the part of WRI concerning the legal status of any country or territory, or concerning the delimitation of frontiers or boundaries.")))};Zt.defaultProps={onBackClick:function(){console.log("Go back button was pressed.")}};var $t=Zt,ea=function(e){var t=e.className,a=e.height,n=e.width,r=e.fill;return E.a.createElement("div",{className:t,style:{display:"inline-block",backgroundColor:r,height:a,width:n}})};ea.defaultProps={height:"11px",width:"11px",fill:"#000000"};var ta=ea,aa=function(e){var t=e.indicators,a=e.config,n=a.fields,r=a.palette,c=a.length;if(!t)return null;var o=function(e,t){return e[t%e.length]};return E.a.createElement(j.Fragment,null,n.map(function(e,a){if(!t[e])return null;var n=t[e].score;return E.a.createElement("div",{key:e},E.a.createElement("span",{className:"widget--chart-text"},"".concat(n)),E.a.createElement(ta,{fill:o(r,a),width:"".concat(c(n),"px")}))}))},na=function(e){var t=e.classes,a=e.rowNumber,n=e.country,r=e.chartConfig;return E.a.createElement("div",{className:Yt()("c-widget",Object(N.a)({},t.row,Boolean(t.row)))},E.a.createElement("div",{className:t.columns[0]},a),E.a.createElement("div",{className:t.columns[1]},n.name),E.a.createElement("div",{className:t.columns[2]},E.a.createElement(aa,{indicators:n.indicators,config:r})),Object.values(n.indicators).length>1?E.a.createElement("div",{className:t.columns[3]},n.indicators.Tot&&n.indicators.Tot.score):null)},ra=["#3FA989","#00A0E1","#4A596A"],ca=["Irr","Dom","Ind","Pop"],oa={row:"widgets--content-row",columns:["widgets--row-number","widgets--name","widgets--chart","widgets--total"]},ia=function(e){var t=e.title,a=e.buttonText,n=e.data,r=e.onSelect,c=n.data,o=n.stats;if(!c.length||0===c.length)return null;var i=Object.entries(c[0].indicators).filter(function(e){return ca.includes(e[0])}).sort(function(e,t){return ca.indexOf(e[0])-ca.indexOf(t[0])}).map(function(e,t){return E.a.createElement("div",{className:"widgets--content-legend",key:e},E.a.createElement(ta,{className:"widgets--content-bullet",fill:ra[t]}),e[1].name)}),s={fields:ca,palette:ra,length:function(e){return 1+(e-o.min)/o.max*75}},u=c.sort(function(e,t){var a=e.indicators,n=a.Tot,r=a.Pop,c=t.indicators,o=c.Tot,i=c.Pop;return n&&o&&n.score&&o.score?parseFloat(o.score)-parseFloat(n.score):r&&i&&r.score&&i.score?parseFloat(i.score)-parseFloat(r.score):0});return E.a.createElement("div",{className:"c-widgets"},E.a.createElement("div",{className:"widgets--header"},E.a.createElement("span",{className:"-uppercase"},t),E.a.createElement("button",{type:"button",onClick:r},a)),E.a.createElement("div",{className:"widgets--content-wrapper"},E.a.createElement("div",{className:"widgets--content-header"},E.a.createElement("div",{className:oa.columns[0]},"Rank"),E.a.createElement("div",{className:oa.columns[1]},"Name"),E.a.createElement("div",{className:oa.columns[2]},"Sectoral Score",i),Object.values(u[0].indicators).length>1?E.a.createElement("div",{className:oa.columns[3]},"Total Score"):null),E.a.createElement("div",{className:"widgets--content-body"},u.map(function(e,t){return E.a.createElement(na,{classes:oa,key:e.iso,rowNumber:t+1,country:e,chartConfig:s})}))))};ia.defaultProps={title:"Water Usage (Score)",buttonText:"Download ranking"};var sa=ia,ua=function(e){return e.scope===te.GENERAL?null:E.a.createElement("footer",{className:"c-footer"},E.a.createElement(D.Field,{name:"countries-filter",label:"Explore more",className:"-bigger"},E.a.createElement(Vt,null)))},la=function(e){var t=e.width,a=e.setWidth,n=e.scope,r=e.headerData,c=e.widget,o=e.setCountry,i=e.saveData,s=Object(j.useRef)(null);Object(j.useEffect)(function(){var e=s.current.offsetWidth;e!==t&&a({data:e})});var u=n===te.GENERAL?"Country Rankings":"Sub-national Rankings";return E.a.createElement("div",{ref:s,className:"dashboard"},n===te.GENERAL?E.a.createElement(Kt,null):E.a.createElement($t,{data:r,onBackClick:function(){return o({data:null})}}),E.a.createElement(sa,{data:c,onSelect:i,title:u}),E.a.createElement(ua,{scope:n}))},da={setCountry:We,saveData:ze,setWidth:$},pa=Object(A.b)(function(e){return{scope:e.dashboard.scope,width:e.dashboard.width,headerData:Bt(e),widget:e.dashboard.widget}},da)(la),ma=function(e){function t(){return Object(T.a)(this,t),Object(Ct.a)(this,Object(St.a)(t).apply(this,arguments))}return Object(Mt.a)(t,e),Object(_.a)(t,[{key:"render",value:function(){var e=this.props.activeLayer.legendConfig;return e&&"choropleth"===e.type?E.a.createElement("div",null,E.a.createElement("ul",{className:"c-legend-type-choropleth"},e.items.map(function(e){var t=e.name,a=e.value,n=e.color;return E.a.createElement("li",{key:"legend-choropleth-item-".concat(t||a)},E.a.createElement("div",{className:"icon-choropleth",style:{backgroundColor:n}}),E.a.createElement("span",{className:"name"},t),E.a.createElement("span",{className:"name"},a))})),e.disclaimer&&E.a.createElement("div",{className:"graph -basic -disclaimer"},E.a.createElement("div",{className:"graph-list"},e.disclaimer.map(function(e){return E.a.createElement("div",{className:"graph-list-item",key:e.name},E.a.createElement("span",{className:"color",style:{background:e.color}}),E.a.createElement("span",{className:"label"},e.name))})))):null}}]),t}(E.a.PureComponent);ma.defaultProps={activeLayer:{}};var fa=ma,ba=a(117),ha=a(238),ga=a.n(ha),va={url:"https://api.tiles.mapbox.com/v4/wri.acf5a04e/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoid3JpIiwiYSI6IjU3NWNiNGI4Njc4ODk4MmIyODFkYmJmM2NhNDgxMWJjIn0.v1tciCeBElMdpnrikGDrPg",options:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank" rel="noopener noreferrer">OpenStreetMap</a>'}},Oa={osm:{id:"osm",value:"https://api.tiles.mapbox.com/v4/wri.c974eefc/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoid3JpIiwiYSI6IjU3NWNiNGI4Njc4ODk4MmIyODFkYmJmM2NhNDgxMWJjIn0.v1tciCeBElMdpnrikGDrPg",label:"Light",options:{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank" rel="noopener noreferrer">OpenStreetMap</a>'}},satellite:{id:"satellite",value:"https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",label:"Satellite",options:{attribution:'&copy; <a href="https://www.google.com/maps/@15,-2.970703,3z?hl=es" target="_blank">Google</a>'}},terrain:{id:"terrain",value:"https://api.mapbox.com/styles/v1/resourcewatch/cjhqi456h02pg2rp6w2mwp61c/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoicmVzb3VyY2V3YXRjaCIsImEiOiJjajFlcXZhNzcwMDBqMzNzMTQ0bDN6Y3U4In0.FRcIP_yusVaAy0mwAX1B8w",label:"Terrain",options:{attribution:'<a href="https://www.mapbox.com/about/maps/" target="_blank">\xa9 Mapbox</a> <a href="http://www.openstreetmap.org/about/" target="_blank">\xa9 OpenStreetMap</a>'}},hydro:{id:"hydro",value:"https://api.mapbox.com/styles/v1/resourcewatch/cjtr6fhr3060g1fok829tfwm7/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoicmVzb3VyY2V3YXRjaCIsImEiOiJjajFlcXZhNzcwMDBqMzNzMTQ0bDN6Y3U4In0.FRcIP_yusVaAy0mwAX1B8w",label:"Hydrography",options:{attribution:'<a href="https://www.mapbox.com/about/maps/" target="_blank">\xa9 Mapbox</a> <a href="http://www.openstreetmap.org/about/" target="_blank">\xa9 OpenStreetMap</a>'}}},ya=function(e){function t(e){var a;return Object(T.a)(this,t),(a=Object(Ct.a)(this,Object(St.a)(t).call(this,e))).state={active:!1},a._onScreenClick=a.onScreenClick.bind(Object(ba.a)(a)),a}return Object(Mt.a)(t,e),Object(_.a)(t,[{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onScreenClick)}},{key:"onScreenClick",value:function(e){var t=document.querySelector(".c-basemap-tooltip");t&&t.contains&&!t.contains(e.target)&&this.toggleDropdown(!1)}},{key:"onBasemapChange",value:function(e){var t=e.value;this.props.setBasemap(t)}},{key:"toggleDropdown",value:function(e){var t=this,a="undefined"!==typeof e&&null!==e?e:!this.state.active;this.setState({active:a}),requestAnimationFrame(function(){e?window.addEventListener("click",t._onScreenClick):window.removeEventListener("click",t._onScreenClick)}),this.setState({active:a})}},{key:"render",value:function(){var e=this,t=this.props.basemap,a=this.state.active;return E.a.createElement(ga.a,{attachment:"top right",constraints:[{to:"window"}],targetOffset:"8px 100%",classes:{element:"c-basemap-tooltip -arrow-right"}},E.a.createElement("button",{type:"button",className:"basemap-button",onClick:function(){return e.toggleDropdown(!0)}},E.a.createElement(D.Icon,{name:"layers",className:"-small"})),a&&E.a.createElement("div",null,E.a.createElement(D.RadioGroup,{items:Object.keys(Oa).map(function(e){var t=Oa[e];return{label:t.label,value:t.id}}),name:"basemap",selected:t,onChange:function(t){e.onBasemapChange(t)}}),E.a.createElement("div",{className:"divisor"})))}}]),t}(j.PureComponent),ja=Object(A.b)(function(e){return{basemap:e.map.basemap}},{setBasemap:ue})(ya),Ea=a(239),wa=a(158),ka=function(e){function t(){var e,a;Object(T.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(Ct.a)(this,(e=Object(St.a)(t)).call.apply(e,[this].concat(r)))).state={latlng:null,interactions:{}},a}return Object(Mt.a)(t,e),Object(_.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=void 0===a?"":a,r=t.viewport,c=t.layers,o=t.bounds,i=t.basemap,s=t.scope,u=t.setLayersOpacity,l=t.setModalState,d=Object(C.a)({},Oa[i||"osm"],{url:Oa[i||"osm"].value}),p={customClass:n,mapOptions:{zoom:r.zoom,center:{lat:r.latitude,lng:r.longitude}},bounds:o,basemap:d,events:{zoomend:function(e,t){},dragend:function(e,t){}}},m=c&&c.length?c.map(function(e){return{name:e.name,dataset:e.dataset,layers:[Object(C.a)({},e,{active:!0})]}}):[];"COUNTRY"!==s&&(p.label=va);var f=function(){l(!0)};return E.a.createElement(Rt.Map,p,function(t){return window.m=t,E.a.createElement(j.Fragment,null,E.a.createElement(wa.LayerManager,{map:t,plugin:Ea.a,onReady:function(){}},c.map(function(t){return E.a.createElement(wa.Layer,Object.assign({key:t.id},t,!!t.interactionConfig&&!!t.interactionConfig.output&&!!t.interactionConfig.output.length&&{interactivity:"carto"!==t.provider&&"cartodb"!==t.provider||t.interactionConfig.output.map(function(e){return e.column}),events:{click:function(t){e.setState({interactionData:t.data,latlng:t.latlng})}}}))})),E.a.createElement(Rt.MapControls,null,E.a.createElement(Rt.ZoomControl,{map:t}),E.a.createElement(ja,null),E.a.createElement("button",{type:"button",onClick:f},E.a.createElement(Rt.Icon,{className:"-medium",name:"icon-share"}))),E.a.createElement(Rt.MapPopup,{map:t,latlng:e.state.latlng,data:{latlng:e.state.latlng,interactions:e.state.interactions}},e.state.interactionData?E.a.createElement("div",{className:"c-map-popup"},E.a.createElement("div",{className:"popup-header"},e.state.interactionData.name_1?E.a.createElement(E.a.Fragment,null,E.a.createElement("h3",null,e.state.interactionData.name_1),E.a.createElement("h4",null,e.state.interactionData.name_0)):E.a.createElement("h3",null,e.state.interactionData.name_0)),E.a.createElement("div",null,e.state.interactionData.label)):E.a.createElement("div",null,"No data")),E.a.createElement("div",{className:"c-legend"},E.a.createElement(Rt.Legend,{sortable:!1},m.map(function(e,t){return E.a.createElement(Rt.LegendListItem,{index:t,key:e.dataset,layerGroup:e,onChangeOpacity:function(e,t){return u(t)},toolbar:E.a.createElement(Rt.LegendItemToolbar,null,E.a.createElement(Rt.LegendItemButtonOpacity,{trackStyle:{backgroundColor:"#2E57B8"},handleStyle:{backgroundColor:"#2E57B8"}}))},E.a.createElement(Rt.LegendItemTypes,null,E.a.createElement(fa,null)))}))))})}}]),t}(j.Component);ka.defaultProps={children:null,viewport:{zoom:2,lat:0,lng:0},bounds:{},dragPan:!0,dragRotate:!0,onViewportChange:function(){},onLoad:function(){},onStyleLoad:function(){},setMapViewport:function(){},layers:[]};var Aa=ka,Da={bws:0,drr:1,rfr:2},Na=Object(_t.a)([function(e){return e.layers.list},function(e){return e.dashboard.scope},function(e){return e.dashboard.locationId},function(e){return e.dashboard.indicators.value}],function(e,t,a,n){if(!e)return[];var r=Da[n];if("COUNTRY"===t){var c=e.province_rankings[r];return[Object(C.a)({},c,{opacity:c.opacity||.5,params:Object(C.a)({},c.params,{iso:a})})]}return[Object(C.a)({},e.country_rankings[r],{opacity:e.country_rankings[r].opacity||.5})]}),Ca={setMapViewport:le,setMapBounds:ce,setMapLoaded:de,setMapFlying:pe,setLayersOpacity:ct,setModalState:Fe},Sa=Object(A.b)(function(e){return Object(C.a)({},e.map,{layers:Na(e),scope:e.dashboard.scope})},Ca)(Aa),Ma=function(e){var t=e.isDashboardCollapsed,a=e.isModalOpen,n=e.setDashboardCollapsed,r=e.setModalState;return E.a.createElement("main",{className:"c-main"},E.a.createElement(D.Sidebar,{customClass:"c-aqueduct-sidebar",onToggle:function(e){n(!e)},visible:!t},E.a.createElement(pa,null)),E.a.createElement("div",{className:"map-wrapper"},E.a.createElement(Sa,{className:"c-aqueduct-map"})),E.a.createElement(Nt,{isOpen:a,appElement:"#root",onRequestClose:function(){return r(!1)}},E.a.createElement(Tt,null)))},La={setDashboardCollapsed:Be,getLayers:ot,setModalState:Fe},Ia=Object(A.b)(function(e){return Object(C.a)({},e.app)},La)(Ma),Ra=function(e){var t=e.getLayers,a=e.loadDashboardData;return Object(j.useEffect)(function(){t(),a()},[t,a]),E.a.createElement(Ia,null)},Ta=function(){return E.a.createElement("div",null,E.a.createElement("h1",null,"Not found"))},_a=new Map([["HOME",Ra],["LOCATION",Ra]]),xa=function(e){var t=e.page.current,a=_a.has(t)?_a.get(t):Ta;return E.a.createElement(a,e)},Pa={getLayers:ot,loadDashboardData:Re},Ba=Object(A.b)(function(e){return{page:e.page}},Pa)(xa);a(417),a(629);k.a.render(E.a.createElement(function(){return E.a.createElement(A.a,{store:Dt},E.a.createElement(D.Icons,null),E.a.createElement("div",{className:"header--wrapper"},E.a.createElement(D.Header,{title:"Country Rankings",app:"country-basin-risk-profiles-and-rankings","current-app":"country-basin-risk-profiles-and-rankings"},E.a.createElement("div",null))),E.a.createElement(Ba,null))},null),document.getElementById("root"))}},[[242,1,2]]]);
//# sourceMappingURL=main.bf53f44d.chunk.js.map